/**
 * Copyright (c) 2014 Baidu.com, Inc. All Rights Reserved
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with
 * the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on
 * an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the
 * specific language governing permissions and limitations under the License.
 */

var fs = require('fs');
var path = require('path');

var Q = require('q');
var BosClient = require('.').BosClient;

var config = {
    credentials: {
        ak: '5a8c6fdac5a24d13ac9e20d80d989b29',
        sk: 'ec6d4659a4784ad6a62274827dafbff9'
    }
};
var bucket = 'bce-cdn';
var object = '/ecom/esl/2-1-6/js.js';

var dir = '/Volumes/HDD/Users/leeight/local/leeight.github.com/esl/dist/src';
var target = '/ecom/esl/2-1-6/';

var client = new BosClient(config);

var tasks = fs.readdirSync(dir).map(function (file) {
    var key = target + file;
    var options = {
        'Cache-Control': 'max-age=315360000'
    };
    return client.putObjectFromFile(bucket, key, path.join(dir, file), options).then(function () {
        console.log(key);
    });
});
Q.all(tasks).then(function () {
    console.log('Done.');
});
